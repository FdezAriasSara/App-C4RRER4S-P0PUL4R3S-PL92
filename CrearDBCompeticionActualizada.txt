CREATE TABLE `Atleta` (
	`DNI` VARCHAR(255) NOT NULL AUTO_INCREMENT,
	`Email` VARCHAR(255) NOT NULL UNIQUE,
	`Name` VARCHAR(255) NOT NULL,
	`Surname` VARCHAR(255) NOT NULL,
	`fechaNacimiento` DATE(255) NOT NULL,
	`sexo` ENUM('masculino','femenino') NOT NULL,
	PRIMARY KEY (`DNI`)
);

CREATE TABLE `Competición` (
	`idCompeticion` INT NOT NULL AUTO_INCREMENT,
	`nombre` VARCHAR(255) NOT NULL,
	`fechaCompeticion` DATE NOT NULL,
	`organizador` VARCHAR(255) NOT NULL,
	`plazoInicioInscripcion` DATE NOT NULL,
	`plazoFinInscripcion` INT NOT NULL,
	`tipoCompeticion` VARCHAR(255) NOT NULL,
	`distanciaKm` INT NOT NULL,
	`plazasDisponibles` INT NOT NULL,
	PRIMARY KEY (`idCompeticion`)
);

CREATE TABLE `Inscripción` (
	`idCompeticion` INT NOT NULL,
	`dniAtleta` VARCHAR(255) NOT NULL,
	`estado` VARCHAR(255) NOT NULL,
	`fechaInscripcion` DATE NOT NULL,
	`fechaUltimoCambio` DATE NOT NULL,
	`idCategoria` INT NOT NULL,
	`posicionFinal` INT NOT NULL,
	`tiempoQueTarda` FLOAT NOT NULL,
	PRIMARY KEY (`idCompeticion`,`dniAtleta`)
);

CREATE TABLE `Categoria` (
	`idCategoria` INT NOT NULL AUTO_INCREMENT,
	`nombreCategoria` VARCHAR(255) NOT NULL,
	`edadMin` INT NOT NULL,
	`edadMax` INT NOT NULL,
	`sexo` INT NOT NULL,
	PRIMARY KEY (`idCategoria`)
);

CREATE TABLE `ContieneCategoria` (
	`idCompeticion` INT NOT NULL,
	`idCategoria` INT NOT NULL,
	PRIMARY KEY (`idCompeticion`,`idCategoria`)
);

ALTER TABLE `Inscripción` ADD CONSTRAINT `Inscripción_fk0` FOREIGN KEY (`idCompeticion`) REFERENCES `Competición`(`idCompeticion`);

ALTER TABLE `Inscripción` ADD CONSTRAINT `Inscripción_fk1` FOREIGN KEY (`dniAtleta`) REFERENCES `Atleta`(`DNI`);

ALTER TABLE `Inscripción` ADD CONSTRAINT `Inscripción_fk2` FOREIGN KEY (`idCategoria`) REFERENCES `Categoria`(`idCategoria`);

ALTER TABLE `ContieneCategoria` ADD CONSTRAINT `ContieneCategoria_fk0` FOREIGN KEY (`idCompeticion`) REFERENCES `Competición`(`idCompeticion`);

ALTER TABLE `ContieneCategoria` ADD CONSTRAINT `ContieneCategoria_fk1` FOREIGN KEY (`idCategoria`) REFERENCES `Categoria`(`idCategoria`);





